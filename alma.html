<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Questionnaire pour Alma – Nombres relatifs</title>

<style>
:root{
  --bg-main:#ece9e4;
  --bg-card:#f4f1ec;
  --ink-main:#0b0f2b;
  --ink-soft:#6b6f7a;
  --accent-blue:#3f72f4;
  --accent-pink:#ff9fd6;
  --accent-coral:#ef6234;
  --border:#ddd8cf;
}

*{box-sizing:border-box}

body{
  margin:0;
  padding:24px;
  background:var(--bg-main);
  color:var(--ink-main);
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  display:flex;
  justify-content:center;
}

.app{
  width:min(1100px,100%);
  background:var(--bg-card);
  border-radius:18px;
  padding:28px;
  box-shadow:0 18px 40px rgba(11,15,43,.12);
}

/* ===== TITRE ===== */
h1{
  margin:0;
  font-size:36px;
  font-weight:800;
  letter-spacing:-0.02em;
}
.sub{
  margin-top:6px;
  font-size:14px;
  color:var(--ink-soft);
}

/* ===== LAYOUT ===== */
.main{
  display:grid;
  grid-template-columns: 1.6fr 1fr;
  gap:24px;
  margin-top:24px;
}
@media(max-width:900px){
  .main{grid-template-columns:1fr}
}

/* ===== STATS ===== */
.stats{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  margin:18px 0;
}
.stat{
  background:#fff;
  padding:8px 14px;
  border-radius:999px;
  font-size:13px;
  border:1px solid var(--border);
}

/* ===== CONTROLS ===== */
.controls{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  margin-bottom:16px;
}
select, input{
  padding:8px 12px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#fff;
  color:var(--ink-main);
  font-size:14px;
}
button{
  cursor:pointer;
  border-radius:14px;
  padding:10px 16px;
  font-weight:700;
  border:1px solid var(--border);
  background:#fff;
  color:var(--ink-main);
}
button.primary{
  background:var(--accent-blue);
  color:#fff;
  border:none;
}

/* ===== QUIZ ===== */
.question{
  font-size:34px;
  margin:16px 0;
}
.answers{
  display:grid;
  gap:10px;
}
.choice{
  background:#fff;
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px;
  font-size:16px;
}
.choice:hover{border-color:var(--accent-blue)}
.choice.ok{background:#eef6ff;border-color:var(--accent-blue)}
.choice.bad{background:#fff0f0;border-color:var(--accent-coral)}

.feedback{
  margin-top:14px;
  padding:12px;
  border-radius:12px;
  background:#fff;
  font-size:14px;
  border-left:4px solid var(--accent-blue);
}

/* ===== MINI LEÇON ===== */
.lesson{
  background:#ffffff;
  border-radius:16px;
  padding:20px;
  border:1px solid var(--border);
  position:sticky;
  top:24px;
}
.lesson h2{
  margin:0 0 10px;
  font-size:18px;
}
.lesson ul{
  margin:0;
  padding-left:18px;
  color:var(--ink-soft);
  line-height:1.5;
}
.lesson li{
  margin-bottom:10px;
}
.lesson .example{
  background:#f7f7f7;
  border-radius:10px;
  padding:10px 12px;
  font-size:13px;
  margin-top:10px;
}

/* ===== SNOOPY ===== */
.snoopyBox{
  display:flex;
  justify-content:center;
  margin:14px 0;
}
.snoopyBox img{
  max-width:160px;
  border-radius:14px;
  box-shadow:0 10px 24px rgba(0,0,0,.12);
}
</style>
</head>

<body>
<div class="app">

<h1>Questionnaire pour Alma</h1>
<div class="sub">Additions et soustractions de nombres relatifs</div>

<div class="main">

<!-- ================= COLONNE GAUCHE : QUIZ ================= -->
<div>

  <div class="stats">
    <div class="stat">Question <b id="qnum">1</b> / 20</div>
    <div class="stat">Score <b id="score">0</b></div>
    <div class="stat">Série <b id="streak">0</b></div>
  </div>

  <div class="controls">
    <select id="level">
      <option value="10">Facile (±10)</option>
      <option value="20" selected>Moyen (±20)</option>
      <option value="50">Plus dur (±50)</option>
    </select>

    <select id="mode">
      <option value="qcm" selected>QCM</option>
      <option value="input">Saisie</option>
    </select>

    <button id="restart">Recommencer</button>
  </div>

  <div class="snoopyBox">
    <img id="snoopyImg" src="images/snoopy_calm.png" alt="">
  </div>

  <div class="question" id="question">—</div>
  <div class="answers" id="answers"></div>
  <div class="feedback" id="feedback" style="display:none"></div>

</div>

<!-- ================= COLONNE DROITE : MINI LEÇON ================= -->
<div class="lesson">
  <h2>Mini-leçon</h2>
  <ul>
    <li><b>Addition</b> :  
      mêmes signes → on additionne et on garde le signe.</li>

    <li>Signes différents → on soustrait  
      et on garde le signe du plus grand en valeur.</li>

    <li><b>Soustraction</b> :  
      <i>soustraire</i>, c’est <i>ajouter l’opposé</i>.</li>
  </ul>

  <div class="example">
    Exemple :<br>
    7 − (−3) = 7 + 3 = 10<br><br>
    −8 + 5 = −3
  </div>
</div>

</div>
</div>

<script>
const TOTAL=20;
const SNOOPY={
  calm:"images/snoopy_calm.png",
  happy:"images/snoopy_happy.png",
  encourage:"images/snoopy_encourage.png"
};

let index=1, score=0, streak=0;
let answer=0;

const qnum=qnumEl=document.getElementById("qnum");
const scoreEl=document.getElementById("score");
const streakEl=document.getElementById("streak");
const qEl=document.getElementById("question");
const answersEl=document.getElementById("answers");
const feedbackEl=document.getElementById("feedback");
const snoopyImg=document.getElementById("snoopyImg");

function rand(limit){
  let n=0;
  while(n===0) n=Math.floor(Math.random()*(2*limit+1))-limit;
  return n;
}
function fmt(n){return n<0?"−"+Math.abs(n):n}

function newQuestion(){
  feedbackEl.style.display="none";
  answersEl.innerHTML="";
  snoopyImg.src=SNOOPY.calm;

  const limit=+level.value;
  const a=rand(limit);
  const b=rand(limit);
  const op=Math.random()<0.5?"+":"−";
  answer=op==="+"?a+b:a-b;

  qEl.textContent=`${fmt(a)} ${op} ${fmt(b)}`;

  const set=new Set([answer]);
  while(set.size<4) set.add(answer+Math.floor(Math.random()*5)-2);

  [...set].sort(()=>Math.random()-0.5).forEach(v=>{
    const btn=document.createElement("button");
    btn.className="choice";
    btn.textContent=fmt(v);
    btn.onclick=()=>check(v,btn);
    answersEl.appendChild(btn);
  });
}

function check(val,btn){
  if(val===answer){
    score++; streak++;
    snoopyImg.src=SNOOPY.happy;
  } else {
    streak=0;
    snoopyImg.src=SNOOPY.encourage;
  }

  feedbackEl.style.display="block";
  feedbackEl.textContent=`Réponse correcte : ${fmt(answer)}`;

  scoreEl.textContent=score;
  streakEl.textContent=streak;
  qnum.textContent=++index;

  if(index<=TOTAL) setTimeout(newQuestion,900);
}

restart.onclick=()=>{
  index=1; score=0; streak=0;
  qnum.textContent=1;
  scoreEl.textContent=0;
  streakEl.textContent=0;
  newQuestion();
};

newQuestion();
</script>

</body>
</html>
