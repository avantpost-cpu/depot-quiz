<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Untitled</title>
    

  </head>
    
  <body>
  <!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Module e-learning - highlight fix</title>
<style>
  * { box-sizing: border-box; }
  body {
    margin: 0;
    background: #fff;
    display: flex;
    justify-content: center;
    padding: 0;
  }

  .container {
    width: 100%;
    max-width: 400px;
  }

  .row {
    display: flex;
    margin: 0;
    padding: 0;
    line-height: 0;
  }

  /* Hauteurs fixes selon les segments */
  .row-1 { height: auto; }    /* image principale garde son ratio */
  .row-2 { height: 120px; }  
  .row-3 { height: 100px; }  
  .row-4 { height: 120px; }  

  /* Image principale conserve son ratio */
  .row-1 img {
    display: block;
    width: 100%;
    height: auto;
    margin: 0;
    padding: 0;
  }

  /* Segments alignés */
  .row-2 img, .row-2 video { 
    display:block; width:33.3333%; height:100%; margin:0; padding:0; 
  }
  .row-3 img { display:block; width:50%; height:100%; margin:0; padding:0; }
  .row-4 img { display:block; width:100%; height:100%; margin:0; padding:0; }

  .highlight { cursor: pointer; }

  .highlight-group.dim .highlight {
    filter: grayscale(100%);
    opacity: 0.2;
  }

  .highlight-group.dim .highlight.active {
    filter: grayscale(0%);
    opacity: 1;
    transform: scale(1.01);
  }

  img, video { -webkit-user-drag: none; user-select: none; }
</style>
</head>
<body>
<div class="container">
  <!-- Ligne 1 -->
  <div class="row row-1">
    <img id="img1" src="https://avantpost-cpu.github.io/depot-quiz/urgence2/1.png" alt="image 1">
  </div>

  <!-- Groupe -->
  <div class="highlight-group">
    <!-- Ligne 2 avec vidéo -->
    <div class="row row-2">
      <video autoplay muted loop playsinline>
        <source src="https://avantpost-cpu.github.io/depot-quiz/urgence2/2.mp4" type="video/mp4">
      </video>
      <img class="highlight" id="img3" src="https://avantpost-cpu.github.io/depot-quiz/urgence2/3.png" alt="image 3">
      <img class="highlight" id="img4" src="https://avantpost-cpu.github.io/depot-quiz/urgence2/4.png" alt="image 4">
    </div>

    <!-- Ligne 3 -->
    <div class="row row-3">
      <img class="highlight" id="img5" src="https://avantpost-cpu.github.io/depot-quiz/urgence2/5.png" alt="image 5">
      <img class="highlight" id="img6" src="https://avantpost-cpu.github.io/depot-quiz/urgence2/6.png" alt="image 6">
    </div>

    <!-- Ligne 4 -->
    <div class="row row-4">
      <img class="highlight" id="img7" src="https://avantpost-cpu.github.io/depot-quiz/urgence2/7.png" alt="image 7">
    </div>
  </div>
</div>

<script>
(function () {
  const group = document.querySelector('.highlight-group');
  const img1 = document.getElementById('img1');
  const originalSrc = img1.src;
  const highlights = Array.from(group.querySelectorAll('.highlight'));

  const replacements = {
    'img3': 'https://avantpost-cpu.github.io/depot-quiz/urgence2/1a.png',
    'img4': 'https://avantpost-cpu.github.io/depot-quiz/urgence2/1b.png',
    'img5': 'https://avantpost-cpu.github.io/depot-quiz/urgence2/1e.jpg',
    'img6': 'https://avantpost-cpu.github.io/depot-quiz/urgence2/1d.jpg',
    'img7': 'https://avantpost-cpu.github.io/depot-quiz/urgence2/1c.jpg'
  };

  function activate(img) {
    highlights.forEach(h => h.classList.remove('active'));
    img.classList.add('active');
    group.classList.add('dim');
    if (replacements[img.id]) img1.src = replacements[img.id];
  }

  function clear() {
    highlights.forEach(h => h.classList.remove('active'));
    group.classList.remove('dim');
    img1.src = originalSrc;
  }

  highlights.forEach(img => {
    img.addEventListener('pointerenter', () => activate(img));
    img.addEventListener('pointerleave', () => clear());

    img.addEventListener('touchstart', function (e) {
      e.preventDefault();
      if (img.classList.contains('active')) clear();
      else activate(img);
    }, { passive: false });
  });

  document.addEventListener('touchstart', e => {
    if (!e.target.closest('.highlight')) clear();
  }, { passive: true });

  group.addEventListener('pointerleave', clear);
})();
</script>
</body>
</html>
    
  </body>
  
</html>
